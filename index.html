<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>❤️</title>

<style>
html,body{
    margin:0;
    overflow:hidden;
    background:#000;
}
canvas{
    position:absolute;
    width:100%;
    height:100%;
}
</style>
</head>

<body>
<canvas id="pinkboard"></canvas>

<script>
const canvas=document.getElementById("pinkboard");
const ctx=canvas.getContext("2d");

function resize(){
    canvas.width=innerWidth;
    canvas.height=innerHeight;
}
resize();
window.onresize=resize;

let particles=[];

// phương trình trái tim
function heart(t){
    return {
        x:16*Math.pow(Math.sin(t),3),
        y:13*Math.cos(t)-5*Math.cos(2*t)-2*Math.cos(3*t)-Math.cos(4*t)
    }
}

// tạo pháo hoa tim
function firework(x,y){
    let hue=Math.random()*360;

    for(let i=0;i<180;i++){
        let t=Math.random()*Math.PI*2;
        let p=heart(t);

        let speed=Math.random()*4+2;

        particles.push({
            x,y,
            vx:p.x*speed,
            vy:-p.y*speed,
            life:1,
            hue
        });
    }
}

function update(dt){
    for(let i=particles.length-1;i>=0;i--){
        let p=particles[i];

        p.vy+=60*dt; // gravity
        p.x+=p.vx;
        p.y+=p.vy;
        p.life-=dt*0.5;

        if(p.life<=0) particles.splice(i,1);
    }
}

function draw(){
    ctx.fillStyle="rgba(0,0,0,0.25)";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    particles.forEach(p=>{
        ctx.globalAlpha=p.life;

        ctx.fillStyle=`hsl(${p.hue},100%,60%)`;
        ctx.shadowColor=`hsl(${p.hue},100%,60%)`;
        ctx.shadowBlur=15;

        ctx.beginPath();
        ctx.arc(p.x,p.y,2,0,Math.PI*2);
        ctx.fill();
    });

    ctx.shadowBlur=0;
    ctx.globalAlpha=1;
}

let last=0;
function loop(t){
    let dt=(t-last)/1000;
    last=t;

    if(Math.random()<0.03){
        firework(
            Math.random()*canvas.width,
            Math.random()*canvas.height*0.6
        );
    }

    update(dt);
    draw();
    requestAnimationFrame(loop);
}
requestAnimationFrame(loop);

// click bắn pháo hoa
canvas.onclick=e=>firework(e.clientX,e.clientY);
</script>
</body>
</html>
